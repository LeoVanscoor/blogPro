{% extends 'base.html.twig' %}

{% block title %}Admin Dashboard
{% endblock %}

{% block body %}
	<h1>Administration</h1>

	<div
		class="container">
		<!-- Bouton pour créer un nouvel article -->
		<a href="{{ path('app_blog_post_new') }}" class="btn btn-primary mb-3">Créer un article</a>

		<!-- Tableau des articles -->
		<h2>Articles</h2>
		<table class="table table-striped">
			<thead>
				<tr>
					<th>ID</th>
					<th>Titre</th>
					<th>Contenu</th>
					<th>Date de Mise à Jour</th>
					<th>Actions</th>
				</tr>
			</thead>
			<tbody>
				{% for post in blogPosts %}
					<tr>
						<td>{{ post.id }}</td>
						<td>{{ post.Titre }}</td>
						<td>{{ post.Contenu}}</td>
						<td>{{ post.lastUpdated|date('Y-m-d H:i') }}</td>
						<td>
							<a href="{{ path('app_blog_post_show', {'id': post.id}) }}" class="btn btn-primary btn-sm">Afficher</a>
							<a href="{{ path('app_blog_post_edit', {'id': post.id}) }}" class="btn btn-warning btn-sm">Éditer</a>
							<form action="{{ path('app_blog_post_delete', {'id': post.id}) }}" method="post" style="display:inline;">
								<button type="submit" class="btn btn-danger btn-sm">Supprimer</button>
							</form>
						</td>
					</tr>
				{% endfor %}
			</tbody>
		</table>

		<!-- Tableau des commentaires -->
		<h2>Commentaires</h2>
		{% for type, messages in app.flashes %}
			{% for message in messages %}
				<div class="alert alert-{{ type }}">
					{{ message }}
				</div>
			{% endfor %}
		{% endfor %}
		<table class="table table-striped">
			<thead>
				<tr>
					<th>ID</th>
					<th>Auteur</th>
					<th>Contenu</th>
					<th>Date</th>
					<th>Actions</th>
				</tr>
			</thead>
			<tbody>
				{% for commentaire in commentaires %}
					<tr>
						<td>{{ commentaire.id }}</td>
						<td>{{ commentaire.author.email }}</td>
						<td>{{ commentaire.Contenu }}</td>
						<td>{{ commentaire.dateCreation|date('Y-m-d H:i') }}</td>
						<td>
							<form action="{{ path('app_commentaire_edit', {'id': commentaire.id}) }}" method="get" style="display:inline;">
								<button type="submit" class="btn btn-warning btn-sm">Éditer</button>
							</form>
							<form action="{{ path('app_commentaire_delete', {'id': commentaire.id}) }}" method="post" style="display:inline;">
								<button type="submit" class="btn btn-danger btn-sm">Supprimer</button>
							</form>
							{% if not commentaire.isValidation %}
								<form action="{{ path('app_commentaire_validate', { id: commentaire.id }) }}" method="post" style="display:inline;">
									<button type="submit" class="btn btn-success">Valider</button>
								</form>
							{% endif %}
						</td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
{% endblock %}
